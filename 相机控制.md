# 相机控制

## 俯视相机过渡到第一人称

### 前置条件

#### 最简过程

* 俯视时相机为观察地图模式
* 俯视时相机始终对准目标点 - 即人物所在点
* 俯视时相机摆正, 看X-Z平面
  * 看向Y负方向
* 镜头X轴进行旋转,从垂直向下变化到水平向前
  * 看向Z正方向

#### 设计

* 相机向人物逼近
* 视野范围在变小(比例尺,相机俯视情况下，观察的X-Z平面纵向的真实距离<Z轴范围>)
* 视野角度在平滑变化

#### 计算

* 以比例尺计算过渡进度 - 比例尺(1:X)值取分母 
  * 过渡进度 = (当前比例尺值 - 起始比例尺值) / (结束比例尺 - 起始比例尺值); 过渡进度 取 0-1
  * 俯视时进度为 0, 结束时进度为 1
* 相机与目标点距离 = (当前比例尺值/2) / tan(相机fov/2)
* 相机角度 = 起始角度 * (1.0 - 进度) + 结束角度 * 进度

#### 附加

* 人物第一人称视角并不一定是 看向Z正方向的
  * 计算视角与标准情况下视角的差值, 随进度叠加到结果上
* 希望下落过程在倾斜角度时能观察到较大范围
  * 美术效果
  * 角度变化先快后慢, 快速变化到45度 - 在较高高度有45度的观察
  * 进度 原本在比例尺上是线性变化, 对值取 0.4 次方, 即先快后慢

